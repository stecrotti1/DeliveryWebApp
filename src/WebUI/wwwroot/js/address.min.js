function getCoordinates(n,t){fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${n.coords.longitude},${n.coords.latitude}.json?limit=1&access_token=${mapboxAccessToken}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(i=>{i.status===200&&i.json().then(i=>{t.value=i.features[0].place_name,t.setAttribute("data-lat",n.coords.latitude),t.setAttribute("data-lng",n.coords.longitude)})}).catch(n=>window.alert(n))}function uploadAddress(n){fetch("/api/addresses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(n=>{n.status===200?(console.log("Address uploaded"),window.location.reload()):window.alert(`Error: ${n.status}`)}).catch(n=>window.alert(n))}function deleteAddress(n,t,i,r,u){fetch(`/api/addresses/${n}`,{method:"DELETE"}).then(n=>{n.status===200?(console.log("Address deleted"),t.value="",t.removeAttribute("disabled"),hideItem(i),showItem(r),showItem(u),disableBtn(u)):window.alert(`Error: ${n.status}`)}).catch(n=>window.alert(n))}function getSuggestions(n){const i=countryCodeEl.getAttribute("data-country"),r=langCodeEl.getAttribute("data-lang");let t=[];return fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${n}.json?autocomplete=true&types=address&country=${i}&language=${r}&limit=5&access_token=${mapboxAccessToken}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(n=>{n.status===200&&n.json().then(n=>{n.features.forEach(n=>{t.push({value:n.place_name,lat:n.center[1],lng:n.center[0]})})})}).catch(n=>window.alert(n)),t}function hideItem(n){n.setAttribute("hidden","")}function showItem(n){n.removeAttribute("hidden")}function enableBtn(n){n.removeAttribute("disabled")}function disableBtn(n){n.setAttribute("disabled","disabled")}function Address(n,t,i,r,u,f,e,o){this.id=n;this.customer=t;this.customerId=i;this.restaurateur=r;this.restaurateurId=u;this.placeName=f;this.latitude=e;this.longitude=o}const mapboxAccessToken="pk.eyJ1Ijoic3RlY3JvdHRpMSIsImEiOiJja3Bna2kzbHYyaThoMm9ueHl1dzlnaTc1In0.EpALSOaDOmuM8XGS_IQzvA",locationFirstBtn=document.getElementById("location-first-address-btn"),locationSecondBtn=document.getElementById("location-second-address-btn"),inputFirstAddress=document.getElementById("input-first-address"),inputSecondAddress=document.getElementById("input-second-address"),firstAddressForm=document.getElementById("first-address-form"),secondAddressForm=document.getElementById("second-address-form"),customerIdEl=document.getElementById("customer-id"),countryCodeEl=document.getElementById("country-code"),langCodeEl=document.getElementById("lang-code"),saveFirstAddressBtn=document.getElementById("save-first-address-btn"),saveSecondAddressBtn=document.getElementById("save-second-address-btn"),firstForm=document.getElementById("first-form"),secondForm=document.getElementById("second-form"),deleteFirstAddressBtn=document.getElementById("delete-first-address-btn"),deleteSecondAddressBtn=document.getElementById("delete-second-address-btn");locationFirstBtn.addEventListener("click",()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(n=>{getCoordinates(n,inputFirstAddress),enableBtn(saveFirstAddressBtn)})});locationSecondBtn.addEventListener("click",()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(n=>{getCoordinates(n,inputSecondAddress),enableBtn(saveSecondAddressBtn)})});inputFirstAddress.addEventListener("input",()=>{if(inputFirstAddress.value.length>0){enableBtn(saveFirstAddressBtn);const n=getSuggestions(inputFirstAddress.value);$("#input-first-address").autocomplete({source:n,focus:function(n,t){return inputFirstAddress.value=t.item.value,!1},select:function(n,t){inputFirstAddress.setAttribute("data-lat",t.item.lat);inputFirstAddress.setAttribute("data-lng",t.item.lng)}})}else disableBtn(saveFirstAddressBtn)});inputSecondAddress.addEventListener("input",()=>{if(inputSecondAddress.value.length>0){enableBtn(saveSecondAddressBtn);const n=getSuggestions(inputSecondAddress.value);$("#input-second-address").autocomplete({source:n,focus:function(n,t){return inputSecondAddress.value=t.item.value,!1},select:function(n,t){inputSecondAddress.setAttribute("data-lat",t.item.lat);inputSecondAddress.setAttribute("data-lng",t.item.lng)}})}else disableBtn(saveSecondAddressBtn)});saveFirstAddressBtn&&(disableBtn(saveFirstAddressBtn),saveFirstAddressBtn.addEventListener("click",()=>{const n=new Address(null,null,customerIdEl.getAttribute("data-id"),null,null,inputFirstAddress.value,inputFirstAddress.getAttribute("data-lat"),inputFirstAddress.getAttribute("data-lng"));uploadAddress(n)}));saveSecondAddressBtn&&(disableBtn(saveSecondAddressBtn),saveSecondAddressBtn.addEventListener("click",()=>{const n=new Address(null,null,customerIdEl.getAttribute("data-id"),null,null,inputSecondAddress.value,inputSecondAddress.getAttribute("data-lat"),inputSecondAddress.getAttribute("data-lng"));uploadAddress(n)}));deleteFirstAddressBtn&&deleteFirstAddressBtn.addEventListener("click",()=>{const n=parseInt(inputFirstAddress.getAttribute("data-id"));deleteAddress(n,inputFirstAddress,deleteFirstAddressBtn,locationFirstBtn,saveFirstAddressBtn)});deleteSecondAddressBtn&&deleteSecondAddressBtn.addEventListener("click",()=>{const n=parseInt(inputSecondAddress.getAttribute("data-id"));deleteAddress(n,inputSecondAddress,deleteSecondAddressBtn,locationSecondBtn,saveSecondAddressBtn)});const toolTipTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')),tooltipList=toolTipTriggerList.map(function(n){return new bootstrap.Tooltip(n)});